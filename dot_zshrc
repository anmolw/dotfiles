# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

# Set PATH

PATH="${HOME}/.local/bin:${PATH}"

#If homebrew is installed, load its completions

if [[ -r /home/linuxbrew/ ]]
then
    eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

if type brew &>/dev/null
then
    FPATH="$(brew --prefix)/share/zsh/site-functions:${FPATH}"
fi

# Download Znap, if it's not there yet.
[[ -r ~/repos/znap/znap.zsh ]] ||
    git clone --depth 1 -- \
        https://github.com/marlonrichert/zsh-snap.git ~/repos/znap
source ~/repos/znap/znap.zsh  # Start Znap

# Run WSL2 SSH Agent bridge

if [[ -n $WSL_DISTRO_NAME ]]
then
    eval "$(~/.bin/wsl2-ssh-agent)"
# If we're running on linux, but not in WSL, use keychain to manage ssh keys
elif [[ $OSTYPE == "linux-gnu" ]]
then
    eval "$(keychain -q -Q --eval id_github)"
fi

# znap prompt sindresorhus/pure

znap source romkatv/powerlevel10k

# `znap install` adds new commands and completions.
znap install zsh-users/zsh-completions

# `znap source` starts plugins.
znap source marlonrichert/zsh-autocomplete

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
